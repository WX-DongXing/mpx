<template>
  <view class="friends-rewrad-box">
    <view bindtap="showStrategyPopup" class="right-icon"></view>
    <view class="invite-friends icon-tit">
      <view class="title">邀好友同出车得现金奖励</view>
      <view class="desc">老用户回归奖励更多</view>
    </view>
    <view class="space-line"></view>
    <view bindtap="showInvitationDialog" class="my-invitation icon-tit">
      <text class="left">我的邀请<text class="desc">（邀请2人开启奖励）</text></text>
      <view class="right">{{infoData.follower_cnt}}人<text class="right-arrow"></text></view>
    </view>
    <view bindtap="showRankDialog" class="ranking icon-tit">
      <text class="left">{{cityName}}邀请排行</text>
      <view class="right">
        <text>{{infoData.raking}}</text>
        <text class="right-arrow"></text>
      </view>
    </view>
  </view>
</template>

<script>
  import { createComponent } from '@mpxjs/core'
  import { strToHtml } from '../../../common/js/utils'
  import { trackEvent } from '../../../common/js/Omega'

  createComponent({
    properties: {
      status: {
        type: String
      },
      info: {
        type: Object
      },
      cityName: {
        type: String
      }
    },
    attached () {
      this.trackEvent('wyc_mkt_ppyuyue_leader_main_rank_invite_history_sw')
    },
    computed: {
      formattedHTMLString () {
        return strToHtml('预约12.31-1.1出车{额外}享流水加倍')
      },
      infoData () {
        return this.info || {
          follower_cnt: 0,
          raking: 0
        }
      }
    },
    methods: {
      showStrategyPopup () {
        this.triggerEvent('showStrategyPopup')
        this.trackEvent('wyc_mkt_ppyuyue_leader_main_rank_invite_history_ck', {
          ck_type: 3
        })
      },
      showInvitationDialog () {
        this.triggerEvent('showInvitationDialog')
        this.trackEvent('wyc_mkt_ppyuyue_leader_main_rank_invite_history_ck', {
          ck_type: 1
        })
      },
      showRankDialog () {
        this.triggerEvent('showRankDialog')
        this.trackEvent('wyc_mkt_ppyuyue_leader_main_rank_invite_history_ck', {
          ck_type: 2
        })
      },
      trackEvent (key, data) {
        const params = {
          sw_type: 1
        }
        trackEvent(key, Object.assign(params, data))
      }
    }
  })
</script>

<style lang="stylus">
@import "../../../common/stylus/mixin.styl"
  .friends-rewrad-box
    position absolute
    bottom vw(49)
    left 0
    width 100%
    height vw(277)
    font-size 0
    background-image url('https://dpubstatic.udache.com/static/dpubimg/91289387-8bd9-4840-b070-ab6c416ecb86.png')
    background-size contain
    background-position center
    background-repeat no-repeat
    .space-line
      position absolute
      top vw(132)
      width 80%
      left 50%
      transform translateX(-50%)
      background-color #ea6a5b
      height 0.5px
    .right-arrow
      display inline-block
      width vw(29)
      height vw(29)
      margin-left 5.5px
      background-image url('https://dpubstatic.udache.com/static/dpubimg/c1479ebd-10d9-4ffc-a23c-52d059a5b324.png')
      background-size contain
      background-position center
      background-repeat no-repeat
    .right-icon
      position absolute
      top vw(20)
      right vw(58.8)
      width vw(58)
      height vw(100)
      z-index 9
      background url('https://dpubstatic.udache.com/static/dpubimg/f5dcf57a-b601-4aea-a8c2-5bd3ac0d9334.png') center no-repeat
      background-size contain
    .icon-tit
      position absolute
      width 100%
      left 0
      padding-left vw(124)
      box-sizing border-box
      background-size vw(41) vw(42)
      background-position vw(72) top
      background-repeat no-repeat
    .invite-friends
      top vw(44)
      background-image url('https://dpubstatic.udache.com/static/dpubimg/164321ea-b56d-488d-ab07-567c95d8188a.png')
      .title
        display block
        font-size 15px
        color #FFEECB
        font-weight bold
        line-height 21px
      .desc
        font-size 12px
        line-height 17px
        color #FFCFB0
    .my-invitation, .ranking
      display flex
      justify-content space-between
      position absolute
      padding-right vw(78.5)
      .left
        font-size 14px
        color #FFEECB
        letter-spacing 0
        line-height 20px
        .desc
          font-size 13px
          color #FFB5B5
          letter-spacing 0
          line-height 20px
      .right
        display flex
        align-items center
        font-size 14px
        color #FFEECB
    .ranking
      position absolute
      top vw(212)
      font-size 14px
      color #FFEECB
      background-image url('https://dpubstatic.udache.com/static/dpubimg/531c9109-e6e8-4f9f-83b2-af2386c76363.png')
    .my-invitation
      top vw(157)
      background-image url('https://dpubstatic.udache.com/static/dpubimg/lWAmAlWxVm/plan.png')
</style>

<script type="application/json">
  {
    "component": true,
    "usingComponents": {
      "bottom-btn": "../button/index"
    }
  }
</script>
